#include <arduino.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "lcd.h"
#include "menu.h"
#include "tch.h"



const short o_ban[24*24]={
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,
0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,
0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,
0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,
0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,};
const short o_ban_c[24*24]={
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,
0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,
0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x0000,0xffff,0xffff,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x0000,0xffff,0xffff,0xffff,0xffff,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0xffff,0xffff,
0xffff,0xffff,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x0000,0xffff,0xffff,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,
0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,
0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,};
const short o_kuro[24*24]={
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,
0x0000,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,
0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,0x0000,
0x0000,0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x07e0,0x0000,0x0000,0x07e0,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,0x0000,0x0000,0x07e0,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x07e0,0x0000,0x0000,0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x07e0,0x0000,0x0000,0x07e0,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,0x0000,
0x0000,0x07e0,0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,
0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,};
const short o_kuro_c[24*24]={
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,
0x0000,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,
0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0xffff,0xffff,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,0x0000,
0x0000,0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0xffff,0xffff,0xffff,0xffff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x07e0,0x0000,0x0000,0x07e0,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,0x0000,0x0000,0x07e0,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x07e0,0x0000,0x0000,0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0xffff,0xffff,0xffff,0xffff,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x07e0,0x0000,0x0000,0x07e0,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0xffff,0xffff,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,0x0000,
0x0000,0x07e0,0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,
0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,};
const short o_shiro[24*24]={
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,
0x0000,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,
0x0000,0x07e0,0x07e0,0x07e0,0x0000,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0000,
0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x0000,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0x0000,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x0000,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0000,0x07e0,
0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x0000,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0x0000,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x0000,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0000,0x07e0,0x0000,
0x0000,0x07e0,0x0000,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0x0000,0x07e0,0x0000,0x0000,0x07e0,0x0000,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0x0000,0x07e0,0x0000,0x0000,0x07e0,
0x0000,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0000,
0x07e0,0x0000,0x0000,0x07e0,0x0000,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0x0000,0x07e0,0x0000,0x0000,0x07e0,0x0000,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0000,0x07e0,0x0000,
0x0000,0x07e0,0x07e0,0x0000,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0x0000,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x0000,0xffff,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0xffff,0x0000,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x0000,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0000,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x0000,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0x0000,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,
0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0x0000,0x0000,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,};
const short o_shiro_c[24*24]={
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,
0x0000,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,
0x0000,0x07e0,0x07e0,0x07e0,0x0000,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0000,
0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x0000,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0x0000,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x0000,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0000,0x07e0,
0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x0000,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0x0000,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x0000,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0000,0x0000,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0000,0x07e0,0x0000,
0x0000,0x07e0,0x0000,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0x0000,0x0000,0x0000,0x0000,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0x0000,0x07e0,0x0000,0x0000,0x07e0,0x0000,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0x0000,0x07e0,0x0000,0x0000,0x07e0,
0x0000,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0000,
0x07e0,0x0000,0x0000,0x07e0,0x0000,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0x0000,0x0000,0x0000,0x0000,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0x0000,0x07e0,0x0000,0x0000,0x07e0,0x0000,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0000,0x0000,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0000,0x07e0,0x0000,
0x0000,0x07e0,0x07e0,0x0000,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0x0000,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x0000,0xffff,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0xffff,0x0000,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x0000,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0000,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x0000,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0x0000,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
0xffff,0xffff,0xffff,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,
0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0xffff,
0xffff,0xffff,0xffff,0xffff,0xffff,0x0000,0x0000,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x0000,0x0000,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,0x07e0,
0x07e0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,};


#define macrox(pos) ((pos)%9)	/* pos ����w���W�ւ̕ϊ� x=1�`8	*/
#define macroy(pos) ((pos)/9)	/* pos ����x���W�ւ̕ϊ� y=1�`8	*/
#define macropos(x,y) ((x)+(y)*9)	/* X,Y ���W���� pos �ւ̕ϊ�	*/
#define abs1(x) ((x)>0 ? (x) : -(x))
#define ISHI_N		0
#define ISHI_K		1
#define ISHI_S		2
#define ISHI_O		3

struct othe_v{
	int tekazu;
	int teban;
	int white;						//0:cpu, 1:human
	int black;						//0:cpu, 1:human
	char goban[100];
//	char msg1[50];
//	char msg2[50];
//	char msg3[50];
	int timesetting;
	int brink_flag;
	int eva_cnt;
	unsigned rnd_init;
};

static struct othe_v othe_v;

static const int othe_dir3[8]={-8,-9,-10,-1,1,8,9,10};

static const struct menu play_menu[] = {
	{0,  0,25, 1,"Black:cpu,   White:cpu"},
	{0, 60,25, 2,"Black:human, White:human"},
	{0,120,25, 3,"Black:cpu,   white:human"},
	{0,180,25, 4,"Black:hunam, White:cpu"},
	{0,0,0,0,0}
};
static const struct menu strong_menu[] = {
	{0, 30, 10, 1,"strong"},
	{0, 90, 10, 2,"normal"},
	{0,150, 10, 3,"weak"},
	{0,0,0,0,0}
};
static const struct menu brink_menu[] = {
    {0, 60, 10, 1,"brink ON"},
    {0,120, 10 ,2,"brink OFF"},
    {0,0,0,0,0}
};

#define T1 8000
#define T2 (-250)
#define T3 30
#define T4 0
#define T5 (-2000)
#define T6 (-10)
#define T7 (-10)
#define T8 (-10)
#define T9 (-10)
#define Ta (-10)
static const int tenpat_std[]={0,0,0,0,0,0,0,0,0,0,
               T1,T2,T3,T4,T4,T3,T2,T1,0,
               T2,T5,T6,T7,T7,T6,T5,T2,0,
               T3,T6,T8,T9,T9,T8,T6,T3,0,
               T4,T7,T9,Ta,Ta,T9,T7,T4,0,
               T4,T7,T9,Ta,Ta,T9,T7,T4,0,
               T3,T6,T8,T9,T9,T8,T6,T3,0,
               T2,T5,T6,T7,T7,T6,T5,T2,0,
               T1,T2,T3,T4,T4,T3,T2,T1,0,
               };

#define U1 8000
#define U2 (-250)
#define U3 30
#define U4 0
#define U5 (-2000)
#define U6 (-10)
#define U7 (-10)
#define U8 (-10)
#define U9 (-10)
#define Ua (-10)
//static const int tenpat_test[]={0,0,0,0,0,0,0,0,0,0,
//               U1,U2,U3,U4,U4,U3,U2,U1,0,
//               U2,U5,U6,U7,U7,U6,U5,U2,0,
//               U3,U6,U8,U9,U9,U8,U6,U3,0,
//               U4,U7,U9,Ua,Ua,U9,U7,U4,0,
//               U4,U7,U9,Ua,Ua,U9,U7,U4,0,
//               U3,U6,U8,U9,U9,U8,U6,U3,0,
//               U2,U5,U6,U7,U7,U6,U5,U2,0,
//               U1,U2,U3,U4,U4,U3,U2,U1,0,
//               };

static const int tenpat_end[] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				T1, T1, T1, T1, T1, T1, T1, T1, 0,
				T1, T1, T1, T1, T1, T1, T1, T1, 0,
				T1, T1, T1, T1, T1, T1, T1, T1, 0,
				T1, T1, T1, T1, T1, T1, T1, T1, 0,
				T1, T1, T1, T1, T1, T1, T1, T1, 0,
				T1, T1, T1, T1, T1, T1, T1, T1, 0,
				T1, T1, T1, T1, T1, T1, T1, T1, 0,
				T1, T1, T1, T1, T1, T1, T1, T1, 0,
};


static void othe_game_init();
static void othe_game();
static int othe_gametop(int *pten);


/********************************************************************************/
/*		othe_main																*/
/********************************************************************************/

void othe_main()
{
	int cmd, x, y;

	othe_v.rnd_init = GetTickCount();
	lcd_clear(WHITE);
	lcd_cdisp_str_x2( 90, "Othello Game");
	lcd_cdisp_str_x1(130, "K.Fukumoto");
	mouse_updown(&x, &y);
	
	lcd_clear(BLACK);
	btn_back_color = YELLOW;
	cmd = menu_select0(play_menu);
	lcd_clear(WHITE);
	if(cmd==1){
		othe_v.black = 0;
		othe_v.white = 0;
	}
	else if(cmd==2){
		othe_v.black = 1;
		othe_v.white = 1;
	}
	else if(cmd==3){
		othe_v.black = 0;
		othe_v.white = 1;
	}
	else{
		othe_v.black = 1;
		othe_v.white = 0;
	}
	
	lcd_clear(BLACK);
//	btn_back_color = MAGENTA;
	cmd = menu_select0(strong_menu);
	lcd_clear(WHITE);
	if(cmd==1){
		othe_v.timesetting = 1000;
	}
	else if(cmd==2){
		othe_v.timesetting = 100;
	}
	else{
		othe_v.timesetting = 10;
	}
    
    lcd_clear(BLACK);
//	btn_back_color = YELLOW;
    cmd = menu_select0(brink_menu);
    lcd_clear(WHITE);
    if(cmd==1){
        othe_v.brink_flag = 1;
    }
    else{
        othe_v.brink_flag = 0;
    }

	lcd_clear(WHITE);
	if(othe_v.timesetting==1000)
		lcd_disp_str_x1(224, 6, "strong");
	else if(othe_v.timesetting==100)
		lcd_disp_str_x1(224, 6, "normal");
	else
		lcd_disp_str_x1(224, 6, " weak");
	
    mouse_button = 0;
	othe_game_init();
	othe_game();
}
/********************************************************************************/
/*		othe_koma0																*/
/*		�Ζ����̋�																*/
/********************************************************************************/
static void othe_koma_pri(int x, int y)
{
	lcd_area_square(20+(x-1)*24, 28+(y-1)*24, 24, 24);
	lcd_write_cmd(MemoryWrite);
}

static void othe_koma(int x, int y, const short *pat)
{
	int i;
	
	if(x<1 || x>8 || y<1 || y>8)
		return;
//	LCD_ALL_S;								// idle
//	LCD_CS_C;								// CS clear
	othe_koma_pri(x, y);
	for(i=0; i<24*24; i++){
		lcd_write_color(pat[i]);
	}
//	LCD_ALL_S;								// idle
}

static void othe_koma0(int x, int y)
{
	othe_koma(x, y, o_ban);
}
static void othe_koma0_c(int x, int y)				// �J�[�\���}�[�N�t��
{
	othe_koma(x, y, o_ban_c);
}
/********************************************************************************/
/*		othe_koma1																*/
/*		����																	*/
/********************************************************************************/
static void othe_koma1(int x, int y)
{
	othe_koma(x, y, o_kuro);
}
static void othe_koma1_c(int x, int y)				// �J�[�\���}�[�N�t��
{
	othe_koma(x, y, o_kuro_c);
}
/********************************************************************************/
/*		othe_koma2																*/
/*		����																	*/
/********************************************************************************/
static void othe_koma2(int x, int y)
{
	othe_koma(x, y, o_shiro);
}
static void othe_koma2_c(int x, int y)				// �J�[�\���}�[�N�t��
{
	othe_koma(x, y, o_shiro_c);
}
/********************************************************************************/
/*		othe_dispban																*/
/*		lcd_area_set(20+(x-1)*24, 28+(y-1)*24, 20+x*24-1, 28+y*24-1);			*/
/********************************************************************************/
static void othe_dispban(char ban[100], int pos)
{
	int x, y, p, k;
	char str[2];
	
	lcd_clear_square(20-1,    28-1,    1,      8*24+2, BLACK);
	lcd_clear_square(20+8*24, 28-1,    1,      8*24+2, BLACK);
	lcd_clear_square(20-1,    28-1,    8*24+2, 1,      BLACK);
	lcd_clear_square(20-1,    28+8*24, 8*24+2, 1,      BLACK);
	for(x=1; x<=8; x++){
		for(y=1; y<=8; y++){
			p = macropos(x,y);
			k = ban[p];
			if(k==ISHI_N)
				othe_koma0(x,y);
			else if(k==ISHI_K)
				othe_koma1(x,y);
			else if(k==ISHI_S)
				othe_koma2(x,y);
		}
	}
	for(x=1; x<=8; x++){
		str[0] = 'A'+x-1;
		str[1] = 0;
		lcd_disp_str_x1(20+(x-1)*24+6, 6, str);
	}
	for(y=1; y<=8; y++){
		str[0] = '1'+y-1;
		str[1] = 0;
		lcd_disp_str_x1(4, 28+(y-1)*24+4, str);
	}
    x = macrox(pos);
    y = macroy(pos);
    if(ban[pos]==ISHI_K)
    	othe_koma1_c(x,y);						// ���J�[�\��
    else if(ban[pos]==ISHI_S)
    	othe_koma2_c(x,y);						// ���J�[�\��
    else
    	othe_koma0_c(x, y);						// �ՃJ�[�\��
}
/********************************************************************************/
/*		othe_human_input														*/
/********************************************************************************/
static int othe_human_input(int pos)
{
	int x, y, tch_x, tch_y;
	
	for(;;){
		mouse_updown(&tch_x, &tch_y);
		x = (tch_x-20)/24 + 1;
		y = (tch_y-28)/24 + 1;
		if(x>=1 && x<=8 && y>=1 && y<=8){
			return macropos(x,y);
		}
	}
}
/********************************************************************************/
/*      othe_brinking                                                           */
/********************************************************************************/
static void othe_brinking(int k, int pos)
{
    int i, x, y;
    
    x = macrox(pos);
    y = macroy(pos);
    for(i=0; i<3; i++){
        if(k==ISHI_K)
            othe_koma1(x,y);
        else
            othe_koma2(x,y);
        wait_ms(500);
        othe_koma0(x,y);
		wait_ms(500);
    }
}

#define macroinv(koma) ((koma)==ISHI_K ? ISHI_S : ISHI_K)

/********************************************************************************/
/*		othe_initban															*/
/********************************************************************************/
static void othe_initban(char *ban)
{
	int x, y, p;
	
	memset(ban, ISHI_O, 100);
	for(x=1; x<=8; x++){
		for(y=1; y<=8; y++){
			p = macropos(x,y);
			ban[p] = ISHI_N;
		}
	}
	ban[macropos(4,4)] = ISHI_S;
	ban[macropos(5,5)] = ISHI_S;
	ban[macropos(4,5)] = ISHI_K;
	ban[macropos(5,4)] = ISHI_K;
}
/********************************************************************************/
/*		othe_game_init															*/
/********************************************************************************/
static void othe_game_init()
{
	othe_initban(othe_v.goban);
	othe_v.tekazu = 1;
	othe_v.teban = ISHI_K;
}
/********************************************************************************/
/*		othe_yomitst															*/
/********************************************************************************/
static int othe_yomitst_s(char *ban, int k, int pos, int dir)
{
	int kk;
	
	if(ban[pos])							// �Ζ����łȂ����
		return 0;							// �łĂȂ�
	pos += dir;
	if(ban[pos] != macroinv(k))				// �G��ɐڐG���Ă��Ȃ����
		return 0;							// �łĂȂ�
	for(;;){
		pos += dir;
		kk = ban[pos];
		if(kk==k)							// �͂���ł���
			return 1;						// �łĂ�
		if(kk==ISHI_N || kk== ISHI_O)
			return 0;						// �łĂȂ�
	}
}

static int othe_yomitst(char *ban, int k, int pos)
{
	int i;
	
	if(ban[pos])							// �Ζ����łȂ����
		return 0;							// �łĂȂ�
	for(i=0; i<8; i++){
		if(othe_yomitst_s(ban, k, pos, othe_dir3[i]))	// dir3 �����őłĂ邩�H
			return 1;						// �łĂ�
	}
	return 0;								// �łĂȂ�
}

/********************************************************************************/
/*		othe_get_upos															*/
/********************************************************************************/
static void othe_get_upos(char *ban, int k, char upos[60], int *upos_cnt)
{
	int p;
	
	*upos_cnt = 0;
	for(p=10; p<81; p++){
		if(othe_yomitst(ban, k, p))				// �łĂ邩�H
			upos[(*upos_cnt)++] = p;
	}
}

//		���̔Ֆʂɑł肪���邩�H
static int upos_tst(char *ban, int k)
{
	char upos[60];
	int upos_cnt;
	
	othe_get_upos(ban, k, upos, &upos_cnt);
	if(upos_cnt==0)
		return 0;								// �łĂȂ�
	return 1;									// �łĂ�
}
/********************************************************************************/
/*		othe_yomiutu															*/
/*		�J���x��Ԃ�															*/
/********************************************************************************/
static int othe_yomiutu(char *ban, int k, int pos)
{
	int i, j, s, p, dir, kaiho;
	
	s = macroinv(k);
	kaiho = 0;
	for(i=0; i<8; i++){
		dir = othe_dir3[i];
		if(othe_yomitst_s(ban, k, pos, dir)){	// dir �����őłĂ邩�H
			p = pos;
			for(;;){
				p += dir;
				if(ban[p]==s){
					ban[p] = k;
					for(j=0; j<8; j++){
						if(ban[p+othe_dir3[j]]==ISHI_N)
							++kaiho;
					}
				}
				else{
					break;
				}
			}
		}
	}
	ban[pos] = k;
	return kaiho;
}
/********************************************************************************/
/*		othe_result																*/
/*		�ΐ��𐔂���A��+														*/
/********************************************************************************/
static int othe_result(char *ban)
{
	int ten, p;
	
	ten = 0;
	for(p=10; p<81; p++){
		if(ban[p]==ISHI_K)
			++ten;
		else if(ban[p]==ISHI_S)
			--ten;
	}
	return ten;
}
/********************************************************************************/
/*		othe_game																*/
/*		�Q�[���i�s�̃��C�����[�`��												*/
/********************************************************************************/
static void othe_game()
{
	int player;								// 0:cpu, 1:human
	int pos, ten;
	int eva;
	int x, y;
	char str[50];
	
	player = othe_v.teban==ISHI_K ? othe_v.black : othe_v.white;
	lcd_disp_str_x1(224, 26, player ? "human    " : "cpu     ");
	pos = macropos(1,1);
	for(;;){
		/***	�p�X�̏���	***/
		if(upos_tst(othe_v.goban, othe_v.teban)==0){		// �łĂȂ�
			othe_v.teban = macroinv(othe_v.teban);
			if(upos_tst(othe_v.goban, othe_v.teban)==0){	// ����Ԃł��łĂȂ�
				ten = othe_result(othe_v.goban);
				if(ten==0)
					lcd_disp_str_x1(224, 66, "Draw     ");
				else{
					lcd_disp_str_x1(224, 66, ten>0 ? "Black    " : "White    ");
					sprintf(str, "%d", abs1(ten));
					lcd_disp_str_x1(224+12*6, 66, str);
				}
    			lcd_disp_str_x1(224, 106, "             ");
				othe_dispban(othe_v.goban, pos);
				mouse_updown(&x, &y);
				return;
			}
			lcd_disp_str_x1(224, 106, "utenai    ");
            othe_dispban(othe_v.goban, pos);
			mouse_updown(&x, &y);
            mouse_button = 0;
			lcd_disp_str_x1(224, 106, "        ");
		}
		player = othe_v.teban==ISHI_K ? othe_v.black : othe_v.white;
		lcd_disp_str_x1(224, 26, player ? "human    " : "cpu     ");
		if(player==0){						// cpu �̎��
			lcd_disp_str_x1(224, 106, "thinking  ");
			othe_dispban(othe_v.goban, pos);
			pos = othe_gametop(&eva);
//			if(mouse_button){			// for break
//				return;
//			}
//			buzzer(1000, 50);
			if(othe_yomitst(othe_v.goban, othe_v.teban, pos)==0){
				printf("game error [%d,%d]", macrox(pos), macroy(pos));
				for(;;)
					;
//				message("game error [%d,%d]", macrox(pos), macroy(pos));
			}
		}
		else{								// �l�Ԃ̎��
			lcd_disp_str_x1(224, 106, "human     ");
			for(;;){
				othe_dispban(othe_v.goban, pos);
				pos = othe_human_input(pos);
                mouse_button = 0;
				if (othe_yomitst(othe_v.goban, othe_v.teban, pos))
					break;
    			lcd_disp_str_x1(224, 106, "*** error     ");
			}
		}
        if(othe_v.brink_flag){
            othe_brinking(othe_v.teban, pos);
        }
		othe_yomiutu(othe_v.goban, othe_v.teban, pos);
		othe_v.teban = macroinv(othe_v.teban);
		++othe_v.tekazu;
	}
}
/********************************************************************************/
/*		othe_gametop															*/
/********************************************************************************/
#define INF 10000000


static int othe_evaluate(char *ban, int k, const int *tenpat, int gamma, int kaiho)
{
	int ten;
	int p;
	
	++othe_v.eva_cnt;
	ten = 0;
	for(p=10; p<81; p++){
		if(ban[p]==ISHI_K)
			ten += tenpat[p];
		else if(ban[p]==ISHI_S)
			ten -= tenpat[p];
	}
//	if(othe_v.tekazu <= 15){
//		ten += MCrnd(40)-20;				// �������Z
//	}
	ten = k==ISHI_K ? ten : -ten;

	ten += 20*gamma;
	ten += 10*kaiho;
	return ten;
}

static int othe_negamax(char *ban, int k, int depth, int maxdepth, int *pos, int alpha, int beta, int pass, int gamma, int kaiho)
{
	int i, upos_cnt, dummy, kho;
	char ban1[100], upos[60];
	int ten, max;
	
	if(depth>=maxdepth){
		return othe_evaluate(ban, k, tenpat_std, gamma, kaiho);	/* ���ԕ]���֐�						*/
	}
	
	max = -INF;
	*pos = 0;
	othe_get_upos(ban, k, upos, &upos_cnt);
	if (upos_cnt == 0){
		if (pass){												// 2��A���p�X
			return othe_evaluate(ban, k, tenpat_end, gamma, kaiho);	/* ���ԕ]���֐�						*/
		}
		return -othe_negamax(ban, macroinv(k), depth + 1, maxdepth, &dummy, -beta, -alpha, 1, -gamma, -kaiho);
	}
//	if(maxdepth-depth >= 4 && upos_cnt >= 2)
//		othe_sort_upos(ban, k, depth+4, maxdepth, upos, upos_cnt);
	gamma = gamma/2 + upos_cnt;
	for(i=0; i<upos_cnt; i++){
		memcpy(ban1, ban, 100);
		if(othe_yomitst(ban1, k, upos[i])==0)			/* �łĂȂ�					*/
			continue;
		kho = othe_yomiutu(ban1, k, upos[i]);
		if(depth<=1)
			kho = kho-kaiho;
		else
			kho = -kaiho;

		ten = - othe_negamax(ban1, macroinv(k), depth+1, maxdepth, &dummy, -beta, -alpha, 0, -gamma, kho);
		if(depth==0 && othe_v.tekazu<=15){
			ten += MCrnd(20)-10;
		}
		if(ten > beta)							/* �}��							*/
			return ten;
		if(max < ten){
			*pos = upos[i];
			max = ten;
			if(max > alpha)
				alpha = max;
		}
	}
	return max;
}

static int othe_gametop(int *pten)
{
	int maxdepth, pos;
	int time1, ten;
	char str[100];
	
	othe_v.eva_cnt = 0;
//	maxdepth = 7;
	time1 = GetTickCount();
	for(maxdepth=1; maxdepth<=10; ++maxdepth){
		ten = othe_negamax(othe_v.goban, othe_v.teban, 0, maxdepth, &pos, -INF, INF, 0, 0, 0);
		if(GetTickCount()-time1 > othe_v.timesetting)
			break;
	}
//	msg_main_printf("depth=%d %ldms ten=%ld cnt=%ld", maxdepth, GetTickCount()-time1, ten, v->eva_cnt);
	sprintf(str, "d=%d %dms ten=%d c=%d          ", maxdepth, (GetTickCount()-time1), ten, othe_v.eva_cnt);
	lcd_disp_str_x1(0, 224, str);
	*pten = ten;
	return pos;
}
/********************************************************************************/
/*		othe_sort_upos															*/
/********************************************************************************/
//struct data {int ten; char upos;};
//
//int othe_cmp_upos(const void *a, const void *b)
//{
//	struct data *aa = (struct data *)a;
//	struct data *bb = (struct data *)b;
//	
//	if(aa->ten==bb->ten)
//		return 0;
//	if(aa->ten > bb->ten)
//		return -1;
//	return 1;
//}
//
//void othe_sort_upos(char *ban, int k, int depth, int maxdepth, char *upos, int upos_cnt)
//{
//	struct data data[60];
//	int i, dummy, kaiho;
//	char ban1[100];
//	
//	for(i=0; i<upos_cnt; i++){
//		data[i].upos = upos[i];
//		memcpy(ban1, ban, 100);
//		kaiho = othe_yomiutu(ban1, k, upos[i]);
//		data[i].ten = -othe_negamax(ban1, macroinv(k), 1, maxdepth-depth+1, &dummy, -INF, INF, 0, 0, kaiho);
//	}
//	qsort(data, upos_cnt, sizeof(struct data), othe_cmp_upos);
//	for(i=0; i<upos_cnt; i++){
//		upos[i] = data[i].upos;
//	}
//}
